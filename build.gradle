group 'starwars-wiki'
version '0.0.1'

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'idea'
apply plugin: 'com.moowork.grunt'

buildscript {
    repositories {
        maven {
            url 'https://plugins.gradle.org/m2/'
        }
    }

    dependencies {
        classpath 'com.moowork.gradle:gradle-grunt-plugin:0.11'
    }
}

repositories {
    mavenCentral()
}

task buildAlexaSkillZip(type: Zip, dependsOn: npmInstall) {
    from('node_modules') {
        into '/'
    }

    from('src/main/js') {
        include "**/*.js"
        into '/'
    }

    from('src/main/resources') {
        include "**/*.json"
        into '/'
    }

    from('.') {
        include "package.json"
        into '/'
    }

    from('src/main/resources') {
        include "**/*.txt"
        into '/resources'
    }
}

task deployAlexaSkill(dependsOn: buildAlexaSkillZip, type: Copy) {
    def zipFile = file('build/distributions/starwars-wiki-0.0.1.zip')
    def outputDir = file("${alexa_home}/starwars-wiki")

    from zipTree(zipFile)
    into outputDir
}